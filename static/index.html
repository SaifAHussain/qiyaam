<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qiyaam — UK Prayer Times</title>
    <meta name="description" content="Shia prayer times for 35 UK cities, according to the Imam Ali Foundation.">
    <link rel="stylesheet" href="/static/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="pattern-bg"></div>
    
    <main>
        <header>
            <div class="ornament">✦</div>
            <h1>Qiyaam</h1>
            <p class="tagline">UK Prayer Times</p>
            <div class="divider">
                <span></span>
                <svg class="star" viewBox="0 0 24 24" width="16" height="16">
                    <polygon points="12,2 15,9 22,9 16,14 18,22 12,17 6,22 8,14 2,9 9,9" fill="currentColor"/>
                </svg>
                <span></span>
            </div>
        </header>

        <section class="city-select">
            <select id="city" aria-label="Select city">
                <option value="aberystwyth">Aberystwyth</option>
                <option value="bangor-wales">Bangor (Wales)</option>
                <option value="birmingham">Birmingham</option>
                <option value="bournemouth">Bournemouth</option>
                <option value="brighton">Brighton</option>
                <option value="bristol">Bristol</option>
                <option value="cambridge">Cambridge</option>
                <option value="cardiff">Cardiff</option>
                <option value="dover">Dover</option>
                <option value="dundee">Dundee</option>
                <option value="edinburgh">Edinburgh</option>
                <option value="exeter">Exeter</option>
                <option value="glasgow">Glasgow</option>
                <option value="hull">Hull</option>
                <option value="leeds">Leeds</option>
                <option value="leicester">Leicester</option>
                <option value="liverpool">Liverpool</option>
                <option value="london" selected>London</option>
                <option value="luton">Luton</option>
                <option value="manchester">Manchester</option>
                <option value="middlesbrough">Middlesbrough</option>
                <option value="milton-keynes">Milton Keynes</option>
                <option value="newcastle">Newcastle</option>
                <option value="norwich">Norwich</option>
                <option value="nottingham">Nottingham</option>
                <option value="oxford">Oxford</option>
                <option value="peterborough">Peterborough</option>
                <option value="plymouth">Plymouth</option>
                <option value="portsmouth">Portsmouth</option>
                <option value="sheffield">Sheffield</option>
                <option value="southampton">Southampton</option>
                <option value="southend-on-sea">Southend-on-Sea</option>
                <option value="stoke-on-trent">Stoke-on-Trent</option>
                <option value="swansea">Swansea</option>
                <option value="swindon">Swindon</option>
            </select>
        </section>

        <section class="times" id="times">
            <div class="time-row">
                <span class="label">Imsaak</span>
                <span class="value" id="imsaak">--:--</span>
            </div>
            <div class="time-row">
                <span class="label">Dawn</span>
                <span class="value" id="dawn">--:--</span>
            </div>
            <div class="time-row">
                <span class="label">Sunrise</span>
                <span class="value" id="sunrise">--:--</span>
            </div>
            <div class="time-row">
                <span class="label">Noon</span>
                <span class="value" id="noon">--:--</span>
            </div>
            <div class="time-row">
                <span class="label">Sunset</span>
                <span class="value" id="sunset">--:--</span>
            </div>
            <div class="time-row">
                <span class="label">Maghrib</span>
                <span class="value" id="maghrib">--:--</span>
            </div>
            <div class="time-row">
                <span class="label">Midnight</span>
                <span class="value" id="midnight">--:--</span>
            </div>
        </section>

        <section class="actions">
            <a href="https://www.icloud.com/shortcuts/568c3e7df9e6495083735671fc4229cd" class="badge" target="_blank">
                <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                    <path d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm0 18c-4.418 0-8-3.582-8-8s3.582-8 8-8 8 3.582 8 8-3.582 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z"/>
                </svg>
                <div class="badge-text">
                    <span class="badge-small">Add to</span>
                    <span class="badge-large">iPhone Shortcuts</span>
                </div>
            </a>
            <p class="hint">London only · Edit shortcut for other cities</p>
            
            <div class="calendar-links">
                <a id="apple-cal" href="#">
                    <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
                        <path d="M19 4h-1V2h-2v2H8V2H6v2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V10h14v10zm0-12H5V6h14v2z"/>
                    </svg>
                    Apple Calendar
                </a>
                <span class="sep">·</span>
                <a id="google-cal" href="#">
                    <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
                        <path d="M19 4h-1V2h-2v2H8V2H6v2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V10h14v10zm0-12H5V6h14v2z"/>
                    </svg>
                    Google Calendar
                </a>
            </div>
        </section>

        <section class="api">
            <h2>API</h2>
            <div class="endpoints">
                <code>/<span class="city-slug">london</span>/today</code>
                <code>/<span class="city-slug">london</span>/tomorrow</code>
                <code>/<span class="city-slug">london</span>/<em>month</em>/<em>day</em></code>
                <code>/<span class="city-slug">london</span>/calendar.ics</code>
            </div>
        </section>

        <footer>
            <p>According to the <a href="https://najaf.org/english/" target="_blank">Imam Ali Foundation</a></p>
        </footer>
    </main>

    <script>
        const city = document.getElementById('city');
        const prayers = ['imsaak', 'dawn', 'sunrise', 'noon', 'sunset', 'maghrib', 'midnight'];

        async function fetchTimes() {
            const slug = city.value;
            try {
                const res = await fetch(`/${slug}/today`);
                const data = await res.json();
                prayers.forEach(p => {
                    document.getElementById(p).textContent = data[p] || '--:--';
                });
            } catch (e) {
                prayers.forEach(p => {
                    document.getElementById(p).textContent = '--:--';
                });
            }
            updateLinks();
        }

        function updateLinks() {
            const slug = city.value;
            document.getElementById('google-cal').href = 
                `https://www.google.com/calendar/render?cid=webcal://${location.host}/${slug}/calendar.ics?days=365`;
            document.getElementById('apple-cal').href = 
                `webcal://${location.host}/${slug}/calendar.ics?days=365`;
            document.querySelectorAll('.city-slug').forEach(el => {
                el.textContent = slug;
            });
        }

        city.addEventListener('change', fetchTimes);
        fetchTimes();
    </script>
</body>
</html>
